{"version":3,"sources":["../../../../src/apps/auth/services/auth.service.ts"],"sourcesContent":["import { HttpException, HttpStatus, Injectable } from '@nestjs/common';\nimport { UserService } from 'src/apps/user/service/user.service';\nimport { LoginDto } from 'src/dto/user/user.dto';\nimport { JwtService } from '@nestjs/jwt';\n\n@Injectable()\nexport class AuthService {\n  constructor(\n    private readonly user: UserService,\n    private readonly jwt: JwtService,\n  ) {}\n\n  async authentication(data: LoginDto) {\n    const user = await this.user.findByEmail(data.email);\n    if (!user) {\n      throw new HttpException('User not found', HttpStatus.NOT_FOUND);\n    }\n    const access = await this.generateToken(user.id);\n    return access;\n  }\n\n  async generateToken(id: number) {\n    return { access_token: this.jwt.sign({ id: id }) };\n  }\n\n  async logout(token: string) {\n    const access = await this.jwt.verify(token);\n    if (!access) {\n      throw new HttpException('Invalid token', HttpStatus.UNAUTHORIZED);\n    }\n    return { message: 'Logout successful' };\n  }\n}\n"],"names":["AuthService","authentication","data","user","findByEmail","email","HttpException","HttpStatus","NOT_FOUND","access","generateToken","id","access_token","jwt","sign","logout","token","verify","UNAUTHORIZED","message","constructor"],"mappings":";;;;+BAMaA;;;eAAAA;;;wBANyC;6BAC1B;qBAED;;;;;;;;;;AAGpB,IAAA,AAAMA,cAAN,MAAMA;IAMX,MAAMC,eAAeC,IAAc,EAAE;QACnC,MAAMC,OAAO,MAAM,IAAI,CAACA,IAAI,CAACC,WAAW,CAACF,KAAKG,KAAK;QACnD,IAAI,CAACF,MAAM;YACT,MAAM,IAAIG,qBAAa,CAAC,kBAAkBC,kBAAU,CAACC,SAAS;QAChE;QACA,MAAMC,SAAS,MAAM,IAAI,CAACC,aAAa,CAACP,KAAKQ,EAAE;QAC/C,OAAOF;IACT;IAEA,MAAMC,cAAcC,EAAU,EAAE;QAC9B,OAAO;YAAEC,cAAc,IAAI,CAACC,GAAG,CAACC,IAAI,CAAC;gBAAEH,IAAIA;YAAG;QAAG;IACnD;IAEA,MAAMI,OAAOC,KAAa,EAAE;QAC1B,MAAMP,SAAS,MAAM,IAAI,CAACI,GAAG,CAACI,MAAM,CAACD;QACrC,IAAI,CAACP,QAAQ;YACX,MAAM,IAAIH,qBAAa,CAAC,iBAAiBC,kBAAU,CAACW,YAAY;QAClE;QACA,OAAO;YAAEC,SAAS;QAAoB;IACxC;IAxBAC,YACE,AAAiBjB,IAAiB,EAClC,AAAiBU,GAAe,CAChC;aAFiBV,OAAAA;aACAU,MAAAA;IAChB;AAsBL"}